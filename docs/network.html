
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Network &#8212; FallModel 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Agents" href="agent.html" />
    <link rel="prev" title="Reset" href="reset.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="agent.html" title="Agents"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reset.html" title="Reset"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FallModel 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="network">
<h1>Network<a class="headerlink" href="#network" title="Permalink to this headline">¶</a></h1>
<p>There are two versions of the network used in the current modelling. The first only features a single Intervention node.
The second features two intervention nodes.</p>
<p>The network centres around the Home node which has connections to and from the Hospital, GP, Social and Intervention
nodes and a connection to the Care node (which is a sink node). The other edges in the system mostly signify falls,
edges to GP from Interventions, Social and Home nodes are there for moderate falls. Likewise the same set of nodes have
edges to Hospital are for severe falls. The last edge from Hospital to Care is like the edge from Home to Care which is
for agents with mobility less than zero.</p>
<div class="section" id="control-and-parameter-setting-network">
<h2>Control and Parameter Setting Network<a class="headerlink" href="#control-and-parameter-setting-network" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/FallInterventionNetwork.png"><img alt="Network of nodes, Home in the center with Hospital, GP, Intervention, Social and Care nodes around it. Edges run to and from all the nodes to home except Care which only have incoming edges from Home and Hospital and no outgoing edges. There are also edges from Intervention and Social to Hospital and GP." src="_images/FallInterventionNetwork.png" style="width: 400px;" /></a>
</div>
<div class="section" id="other-specifications-network">
<h2>Other Specifications Network<a class="headerlink" href="#other-specifications-network" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/FallInterventionOpenNetwork.png"><img alt="Network of nodes, Home in the center with Hospital, GP, Intervention, Open Intervention, Social and Care nodes around it. Edges run to and from all the nodes to home except Care which only have incoming edges from Home and Hospital and no outgoing edges. There are also edges from Intervention, Open Intervention and Social to Hospital and GP." src="_images/FallInterventionOpenNetwork.png" style="width: 400px;" /></a>
</div>
<div class="section" id="node-algorithms">
<h2>Node Algorithms<a class="headerlink" href="#node-algorithms" title="Permalink to this headline">¶</a></h2>
<p>There are many different functions performed in the nodes including perception filtering. We describe the main
algorithms used in individual nodes and fall nodes in general here.</p>
<div class="section" id="fall-checks">
<h3>Fall Checks<a class="headerlink" href="#fall-checks" title="Permalink to this headline">¶</a></h3>
<p>We use a random number and a normal distribution based on the agents mobility to check for falls. We scale the mean to
check for different sorts of falls.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_{severe} = e^{-3m}\\
f_{moderate}=e^{-3(0.9m)}\\
f_{mild}=e^{-3(0.7m)}\end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(m\)</span> is mobility. We sample from a uniform random distribution on the interval [0:1], <span class="math notranslate nohighlight">\(r\)</span>, and starting with severe we check to see if <span class="math notranslate nohighlight">\(r\)</span>
is less than <span class="math notranslate nohighlight">\(f_{severe}\)</span>. If <span class="math notranslate nohighlight">\(r\)</span> is less than the fall value then we dictate that that type of fall will occur.</p>
</div>
<div class="section" id="predicting-falls">
<h3>Predicting Falls<a class="headerlink" href="#predicting-falls" title="Permalink to this headline">¶</a></h3>
<p>To predict the next fall an agent is going to have we use a poisson distribution for each type of fall. We draw a sample
from each distribution, this sample is the time till the next fall of that type. The first type of fall to occur and the
time to it’s occurrence is our fall prediction.</p>
<div class="math notranslate nohighlight">
\[\begin{split}t_{severe} = Pois(-log(1-m))\\
t_{moderate} = Pois(-log(1-0.9m))\\
t_{mild} = Pois(-log(1-0.7m))\\
t_{fall} = min(t_{severe}, t_{moderate}, t_{mild})\end{split}\]</div>
</div>
<div class="section" id="node-perception-filtering">
<h3>Node Perception Filtering<a class="headerlink" href="#node-perception-filtering" title="Permalink to this headline">¶</a></h3>
<p>The standard node perception filtering for fall nodes is based on the edges and end nodes available and the properties
of the agent. There are 3 stages of Perception filtering:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Remove edges from Perception with:</dt><dd><ol class="loweralpha simple">
<li><p>wellbeing limits which the agent does not match</p></li>
<li><p>referral requirement which the agent does not meet</p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If agent_mobility&lt;0 and Care Node in Perception End Nodes:</dt><dd><p>Perception = edge with Care end node</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Perform fall check, if agent falls set agent_wellbeing to ‘Fallen’ and log fall, then:</dt><dd><ol class="loweralpha simple">
<li><p>if Severe fall: Perception = edge with Hospital end node</p></li>
<li><p>if Moderate fall: Perception = edge with GP end node</p></li>
</ol>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="home-prediction">
<h3>Home Prediction<a class="headerlink" href="#home-prediction" title="Permalink to this headline">¶</a></h3>
<p>To calculate  how long the agent will stay at the Home node and possibly where it will go,
[queue time (relative to current time <span class="math notranslate nohighlight">\(t_c\)</span>), destination, duration],  from there we perform the following algorithm:</p>
<ul class="simple">
<li><p>Determine <span class="math notranslate nohighlight">\(minimum\_energy\)</span> requirement for edges leaving Home node</p></li>
<li><dl class="simple">
<dt>If <span class="math notranslate nohighlight">\(agent\_energy &lt; minimum\_energy\)</span>:</dt><dd><ul>
<li><p><span class="math notranslate nohighlight">\(recovery\_time = (minimum\_energy-agent\_energy)/recovery\_rate\)</span></p></li>
<li><p>Predict fall on agent_mobility to get fall_time and fall_type</p></li>
<li><p><span class="math notranslate nohighlight">\(t = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m = agent\_mobility\)</span></p></li>
<li><dl class="simple">
<dt>while <span class="math notranslate nohighlight">\(t &lt;\)</span> fall_time:</dt><dd><ul>
<li><p><span class="math notranslate nohighlight">\(m = m +\)</span> mobility_change\</p></li>
<li><p>[fall_time*, fall_type*] = Predict fall on m \</p></li>
<li><dl class="simple">
<dt>if fall_time* &lt; fall_time:</dt><dd><p>[fall_time, fall_type] = [fall_time*, fall_type*]</p>
</dd>
</dl>
</li>
<li><p><span class="math notranslate nohighlight">\(t = t + 1\)</span></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if fall_time &lt; recovery_time:</dt><dd><ul>
<li><p>log fall</p></li>
<li><p>set agent_wellbeing to ‘Fallen’</p></li>
<li><dl class="simple">
<dt>if fall_type == ‘Severe’:</dt><dd><p>agent queues at [t_c + fall_time, Hospital, fall_time]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if fall_type == ‘Moderate’:</dt><dd><p>agent queues at [t_c + fall_time, GP, fall_time]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if fall_type == ‘Mild’:</dt><dd><p>agent queues at [t_c + recovery_time, None, recovery_time]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>else:</dt><dd><p>agent queues at [t_c + recovery_time, None, recovery_time]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Else:</dt><dd><p>agent queues at [t_c+1, None, 1]</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="hospital-prediction">
<h3>Hospital Prediction<a class="headerlink" href="#hospital-prediction" title="Permalink to this headline">¶</a></h3>
<p>We predict the time an agent will spend in hospital using a sample from a normal distribution. We set the mean such that
individuals with high mobility or high resources spend on average 5 days in hospital from a severe fall.
.. maths:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">r_c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">min</span><span class="p">(</span><span class="n">r_m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is agent_mobility, <span class="math notranslate nohighlight">\(r_c\)</span> is agent_confidence_resources and <span class="math notranslate nohighlight">\(r_m\)</span> is agent_mobility_resources.</p>
</div>
</div>
<div class="section" id="module-Fall_nodes">
<span id="node"></span><h2>Node<a class="headerlink" href="#module-Fall_nodes" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="Fall_nodes.CareNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">CareNode</code><a class="headerlink" href="#Fall_nodes.CareNode" title="Permalink to this definition">¶</a></dt>
<dd><p>This node is not a true node. It is a sink node which only processes agents on arrival. As such it only has an
agentsready function which processes the agents out of the system to save database space.</p>
<dl class="py method">
<dt id="Fall_nodes.CareNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.CareNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves out the log strings of all agents at the Care Node using the runname aquired from the database. Updates
its own track of average number of falls and length of interval using information in agent logs. Also updates
the total number of agents that have left the system. It then deletes the agents at the Care node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="Fall_nodes.FallNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">FallNode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">capacity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">duration</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">queue</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.FallNode" title="Permalink to this definition">¶</a></dt>
<dd><p>FallNode class extends the Node class from SPmodelling with the perception filtering used by all nodes in the
FallModel.</p>
<dl class="py method">
<dt id="Fall_nodes.FallNode.agentperception">
<code class="sig-name descname">agentperception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">dest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waittime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.FallNode.agentperception" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine based on the node what an agent can see in terms of options to move. It filters out overloaded nodes
with no spare capacity, edges which require a referral the agent does not have, edges that do not allow this
type of agent. If Care is an option it directs agents with 0 mobility to Care by removing all other options.
If Hospital and GP are in options a fall is checked for based on the agents mobility, see Fall algorithm for
detection and classification of falls. Severe falls cause the agent to be directed to the Hospital, Moderate
falls direct to the GP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction.</p></li>
<li><p><strong>agent</strong> – The agent object returned from the database via the interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>dest</strong> – (Optional) used for agents whose destination has been predicted, passes the predicted destination</p></li>
<li><p><strong>waittime</strong> – (Optional) integer, time the agent has been waiting at current node for updating the agent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>view, agents filtered perception of their surroundings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.FallNode.agentprediction">
<code class="sig-name descname">agentprediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.FallNode.agentprediction" title="Permalink to this definition">¶</a></dt>
<dd><p>For nodes with queues this function is specialised to add the agents to the queue with a wait time and
destination. Does nothing in this form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – Agent node object returned by interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.FallNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">agentclass</span><span class="o">=</span><span class="default_value">'FallAgent'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.FallNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds Agents ready to move and prompts them to do so and runs prediction for agents on arrival at new nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>agentclass</strong> – Tells the node what type of agents they are handling</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="Fall_nodes.GPNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">GPNode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'GP'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.GPNode" title="Permalink to this definition">¶</a></dt>
<dd><p>GPNode is a subclass of Fall node which extends the Fall node by filtering the agents perception to redirect the
agent home or to the hospital. It also gives the agent a referral if they have lower mobility.</p>
<dl class="py method">
<dt id="Fall_nodes.GPNode.agentperception">
<code class="sig-name descname">agentperception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">dest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waittime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.GPNode.agentperception" title="Permalink to this definition">¶</a></dt>
<dd><p>Add aditional filter to direct the agent to Hospital if mobility below 0.6 and home otherwise. If the agent
is sent home but have mobility below 0.85 they are given a referral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – agent database object returned by interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>dest</strong> – Not used here</p></li>
<li><p><strong>waittime</strong> – Not used here</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>perception with either Home or Hospital as the only destination</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.GPNode.agentprediction">
<code class="sig-name descname">agentprediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.GPNode.agentprediction" title="Permalink to this definition">¶</a></dt>
<dd><p>For nodes with queues this function is specialised to add the agents to the queue with a wait time and
destination. Does nothing in this form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – Agent node object returned by interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.GPNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">agentclass</span><span class="o">=</span><span class="default_value">'FallAgent'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.GPNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds Agents ready to move and prompts them to do so and runs prediction for agents on arrival at new nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>agentclass</strong> – Tells the node what type of agents they are handling</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="Fall_nodes.HomeNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">HomeNode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'Home'</span></em>, <em class="sig-param"><span class="n">mc</span><span class="o">=</span><span class="default_value">- 0.015</span></em>, <em class="sig-param"><span class="n">rr</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">cc</span><span class="o">=</span><span class="default_value">- 0.02</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HomeNode" title="Permalink to this definition">¶</a></dt>
<dd><p>HomeNode is a subclass of FallNode and extends it to add a queue for agents, a prediction algorithm for where an
agent is going next and how long they will be at the home node. As part of this is has a function for predicting
falls including categorication.</p>
<dl class="py method">
<dt id="Fall_nodes.HomeNode.agentperception">
<code class="sig-name descname">agentperception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">dest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waittime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HomeNode.agentperception" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine based on the node what an agent can see in terms of options to move. It filters out overloaded nodes
with no spare capacity, edges which require a referral the agent does not have, edges that do not allow this
type of agent. If Care is an option it directs agents with 0 mobility to Care by removing all other options.
If Hospital and GP are in options a fall is checked for based on the agents mobility, see Fall algorithm for
detection and classification of falls. Severe falls cause the agent to be directed to the Hospital, Moderate
falls direct to the GP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction.</p></li>
<li><p><strong>agent</strong> – The agent object returned from the database via the interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>dest</strong> – (Optional) used for agents whose destination has been predicted, passes the predicted destination</p></li>
<li><p><strong>waittime</strong> – (Optional) integer, time the agent has been waiting at current node for updating the agent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>view, agents filtered perception of their surroundings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.HomeNode.agentprediction">
<code class="sig-name descname">agentprediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HomeNode.agentprediction" title="Permalink to this definition">¶</a></dt>
<dd><p>We check the time it will take the agent to have the recovered the minimum energy required to move to a
different node other than by a fall. We then predict when and kind of the agents next fall. We compare this with
the recovery time to see if the agent will fall before they move. If the agent is going to fall we add them to
the queue at the time step when they will fall and log the fall. In the case of a severe or moderate fall we
also set a destination as Hospital or GP respectively. We add agents with mild falls or recovery before fall are
added to the queue with out a destination but with a duration the same as their recovery time in both cases, if
they have a mild fall we update their wellbeing to “Fallen” as well. It the agent has sufficient energy to act
immediately then they are added to the top of the queue with no duration or destination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – Agent node object returned by interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.HomeNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">agentclass</span><span class="o">=</span><span class="default_value">'FallAgent'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HomeNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>If there are agents ready at this time step the node checks the nodes mobility, confidence and energy modifiers.
It uses those values to update the agent based on the agents duration at the home node. After this agents are
processed as usual for a fall node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>agentclass</strong> – the class of agents this node expects to find and process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.HomeNode.predictfall">
<em class="property">static </em><code class="sig-name descname">predictfall</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mobility</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HomeNode.predictfall" title="Permalink to this definition">¶</a></dt>
<dd><p>We predict how many time steps until the next fall of each type based on a poisson distribution with mean for
severe falls:
-log(1-mobility)
moderate falls:
-log(1-0.9*mobility)
mild falls:
-log(1-0.7*mobility)
We return the earliest fall.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mobility</strong> – Agents current mobility</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[fall time, fall type] for the fall occurring first</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="Fall_nodes.HosNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">HosNode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'Hos'</span></em>, <em class="sig-param"><span class="n">mc</span><span class="o">=</span><span class="default_value">- 0.1</span></em>, <em class="sig-param"><span class="n">rr</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">cc</span><span class="o">=</span><span class="default_value">- 0.05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HosNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends the FallNode class with the addition of prediction of length of hospital stay and modification of agent
values before leaving node based on duration.</p>
<dl class="py method">
<dt id="Fall_nodes.HosNode.agentperception">
<code class="sig-name descname">agentperception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">dest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waittime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HosNode.agentperception" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine based on the node what an agent can see in terms of options to move. It filters out overloaded nodes
with no spare capacity, edges which require a referral the agent does not have, edges that do not allow this
type of agent. If Care is an option it directs agents with 0 mobility to Care by removing all other options.
If Hospital and GP are in options a fall is checked for based on the agents mobility, see Fall algorithm for
detection and classification of falls. Severe falls cause the agent to be directed to the Hospital, Moderate
falls direct to the GP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction.</p></li>
<li><p><strong>agent</strong> – The agent object returned from the database via the interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>dest</strong> – (Optional) used for agents whose destination has been predicted, passes the predicted destination</p></li>
<li><p><strong>waittime</strong> – (Optional) integer, time the agent has been waiting at current node for updating the agent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>view, agents filtered perception of their surroundings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.HosNode.agentprediction">
<code class="sig-name descname">agentprediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HosNode.agentprediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs the agent being admitted to hospital and then calculates mean for poisson distribution to predict the
duration of the agents stay.
mean = min(-9*min(agent_mobility, 1) + 14, -9*(min(agent_confidence_resources, 1) +
min(agent_mobility_resources, 1)) + 14
This means a fully healthy agent has a mean stay of 5 days in hospital after a severe fall. The predicted
duration is drawn from a poisson distribution.
The agent is added to the queue at t = current_time + predicted_duration
with destination home.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – agent database object returned from Interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.HosNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">agentclass</span><span class="o">=</span><span class="default_value">'FallAgent'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.HosNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>If there are agents ready at this time step the node checks the nodes mobility, confidence and energy modifiers.
It uses those values to update the agent based on the agents duration at the Hospital node. It also updates the
agent to give it a referral and logs its discharge from hospital. After this agents are processed as usual for a
fall node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>agentclass</strong> – class of agent the node will be processing</p></li>
</ul>
</dd>
</dl>
<p>:return:None</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="Fall_nodes.InterventionNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">InterventionNode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'Intervention'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.InterventionNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends the Fall Node to manage the capacity limit changes to Intervention nodes and manages the referrals for
agents</p>
<dl class="py method">
<dt id="Fall_nodes.InterventionNode.agentperception">
<code class="sig-name descname">agentperception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">dest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waittime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.InterventionNode.agentperception" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends normal Fall Node function by logging the agents attendance at the intervention. It checks if the agent
has mobility below 0.6, if they do the agent is given a referral (if they didn’t have one) else if they have a
referral is removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – agent database object returned from Interface</p></li>
<li><p><strong>intf</strong> – Interface for calls to database</p></li>
<li><p><strong>dest</strong> – Not used here</p></li>
<li><p><strong>waittime</strong> – Not used here</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>view from Fall Node agentperception</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.InterventionNode.agentprediction">
<code class="sig-name descname">agentprediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.InterventionNode.agentprediction" title="Permalink to this definition">¶</a></dt>
<dd><p>For nodes with queues this function is specialised to add the agents to the queue with a wait time and
destination. Does nothing in this form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – Agent node object returned by interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.InterventionNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">agentclass</span><span class="o">=</span><span class="default_value">'FallAgent'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.InterventionNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends normal Fall node by updating the load value after processing agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>agentclass</strong> – Class to use for agents at this location</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="Fall_nodes.SocialNode">
<em class="property">class </em><code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">SocialNode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'Social'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.SocialNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently a generic FallNode with name “Social”</p>
<dl class="py method">
<dt id="Fall_nodes.SocialNode.agentperception">
<code class="sig-name descname">agentperception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">dest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waittime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.SocialNode.agentperception" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine based on the node what an agent can see in terms of options to move. It filters out overloaded nodes
with no spare capacity, edges which require a referral the agent does not have, edges that do not allow this
type of agent. If Care is an option it directs agents with 0 mobility to Care by removing all other options.
If Hospital and GP are in options a fall is checked for based on the agents mobility, see Fall algorithm for
detection and classification of falls. Severe falls cause the agent to be directed to the Hospital, Moderate
falls direct to the GP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction.</p></li>
<li><p><strong>agent</strong> – The agent object returned from the database via the interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>dest</strong> – (Optional) used for agents whose destination has been predicted, passes the predicted destination</p></li>
<li><p><strong>waittime</strong> – (Optional) integer, time the agent has been waiting at current node for updating the agent</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>view, agents filtered perception of their surroundings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.SocialNode.agentprediction">
<code class="sig-name descname">agentprediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">agent</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.SocialNode.agentprediction" title="Permalink to this definition">¶</a></dt>
<dd><p>For nodes with queues this function is specialised to add the agents to the queue with a wait time and
destination. Does nothing in this form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>agent</strong> – Agent node object returned by interface</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Fall_nodes.SocialNode.agentsready">
<code class="sig-name descname">agentsready</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tx</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">agentclass</span><span class="o">=</span><span class="default_value">'FallAgent'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_nodes.SocialNode.agentsready" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds Agents ready to move and prompts them to do so and runs prediction for agents on arrival at new nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>agentclass</strong> – Tells the node what type of agents they are handling</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="Fall_nodes.random">
<code class="sig-prename descclassname">Fall_nodes.</code><code class="sig-name descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; x in the interval [0, 1).<a class="headerlink" href="#Fall_nodes.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="balancer">
<h2>Balancer<a class="headerlink" href="#balancer" title="Permalink to this headline">¶</a></h2>
<p>There are two forms of the balancer algorithm, the first used by parameter setting. Most of the existing system
specifications do not use network dynamics. The second is used by the dynamic specifications.</p>
<div class="section" id="parameter-setting-balancer">
<h3>Parameter Setting Balancer<a class="headerlink" href="#parameter-setting-balancer" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>IntervalHistory : list of Intervals</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> := Intervention.Capacity</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span> := current average Interval</p></li>
<li><p>IntervalHistory += <span class="math notranslate nohighlight">\([i]\)</span></p></li>
<li><dl class="simple">
<dt>If Interval has increased since last week, and Interval &gt; a week:</dt><dd><p>Intervention.Capacity := <span class="math notranslate nohighlight">\(c+1\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Else if Interval has decreased since last week, and Interval &lt; a week:</dt><dd><p>Intervention.Capacity := max:math:<cite>(c-1,0)</cite></p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="dynamic-capacity-balancer">
<h3>Dynamic Capacity Balancer<a class="headerlink" href="#dynamic-capacity-balancer" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>IntervalHistory : list of Intervals</p></li>
<li><p><span class="math notranslate nohighlight">\(c_c\)</span> := Intervention.Capacity</p></li>
<li><p><span class="math notranslate nohighlight">\(c_o\)</span> := OpenIntervention.Capacity</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span> := current average Interval</p></li>
<li><p>IntervalHistory += <span class="math notranslate nohighlight">\([i]\)</span></p></li>
<li><dl class="simple">
<dt>If Interval has increased since last week, and Interval &gt; a week and <span class="math notranslate nohighlight">\(c_o\)</span>&gt;0:</dt><dd><p>Intervention.Capacity := <span class="math notranslate nohighlight">\(c_c+1\)</span>
OpenIntervention.Capacity := <span class="math notranslate nohighlight">\(c_o-1\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Else if Interval has decreased since last week, and Interval &lt; a week and <span class="math notranslate nohighlight">\(c_c\)</span>&gt;0:</dt><dd><p>Intervention.Capacity := <span class="math notranslate nohighlight">\(c_c-1\)</span>
OpenIntervention.Capacity := <span class="math notranslate nohighlight">\(c_o+1\)</span></p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="module-Fall_Balancer">
<span id="balancer-code"></span><h3>Balancer Code<a class="headerlink" href="#module-Fall_Balancer" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="Fall_Balancer.FlowReaction">
<em class="property">class </em><code class="sig-prename descclassname">Fall_Balancer.</code><code class="sig-name descname">FlowReaction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uri</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">author</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_Balancer.FlowReaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Fall specific implementation of a Balancer for adjusting network values. Applies the adjust capacity rule.</p>
<dl class="py method">
<dt id="Fall_Balancer.FlowReaction.applyrules">
<code class="sig-name descname">applyrules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">txl</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_Balancer.FlowReaction.applyrules" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the adjust capacity rule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>txl</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="Fall_Balancer.adjustcapasity">
<code class="sig-prename descclassname">Fall_Balancer.</code><code class="sig-name descname">adjustcapasity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">txl</span></em>, <em class="sig-param"><span class="n">intf</span></em>, <em class="sig-param"><span class="n">history</span></em>, <em class="sig-param"><span class="n">dynamic</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_Balancer.adjustcapasity" title="Permalink to this definition">¶</a></dt>
<dd><p>Rule function that applies the capacity change algorithm in the  case of two intervention node systems. This is uses
a history variable that is cleared when the capacity is adjusted so that another five timesteps must pass before the
capacity can be changed again. This only modifies OpenIntervention if dynamic is true else only intervention is
modified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>txl</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
<li><p><strong>history</strong> – List of previous average times since discharge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>history</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Fall_Balancer.parselog">
<code class="sig-prename descclassname">Fall_Balancer.</code><code class="sig-name descname">parselog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">log</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_Balancer.parselog" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function, parses log strings from agents and converts them to a list of tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>log</strong> – string log format: “(&lt;event&gt;, &lt;timestep&gt;),…”</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of tuples [(&lt;event&gt;, &lt;timestep&gt;),…]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Fall_Balancer.timesincedischarge">
<code class="sig-prename descclassname">Fall_Balancer.</code><code class="sig-name descname">timesincedischarge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">txl</span></em>, <em class="sig-param"><span class="n">intf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Fall_Balancer.timesincedischarge" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function reports the time between any hospital discharge and attending an intervention. Only recorded if
both events occur.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>txl</strong> – neo4j database write transaction</p></li>
<li><p><strong>intf</strong> – Interface for database calls</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of times in integer timesteps</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Network</a><ul>
<li><a class="reference internal" href="#control-and-parameter-setting-network">Control and Parameter Setting Network</a></li>
<li><a class="reference internal" href="#other-specifications-network">Other Specifications Network</a></li>
<li><a class="reference internal" href="#node-algorithms">Node Algorithms</a><ul>
<li><a class="reference internal" href="#fall-checks">Fall Checks</a></li>
<li><a class="reference internal" href="#predicting-falls">Predicting Falls</a></li>
<li><a class="reference internal" href="#node-perception-filtering">Node Perception Filtering</a></li>
<li><a class="reference internal" href="#home-prediction">Home Prediction</a></li>
<li><a class="reference internal" href="#hospital-prediction">Hospital Prediction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Fall_nodes">Node</a></li>
<li><a class="reference internal" href="#balancer">Balancer</a><ul>
<li><a class="reference internal" href="#parameter-setting-balancer">Parameter Setting Balancer</a></li>
<li><a class="reference internal" href="#dynamic-capacity-balancer">Dynamic Capacity Balancer</a></li>
<li><a class="reference internal" href="#module-Fall_Balancer">Balancer Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="reset.html"
                        title="previous chapter">Reset</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="agent.html"
                        title="next chapter">Agents</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/network.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="agent.html" title="Agents"
             >next</a> |</li>
        <li class="right" >
          <a href="reset.html" title="Reset"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FallModel 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Penny Faulkner Rainford.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.2.
    </div>
  </body>
</html>